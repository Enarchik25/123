from fastapi import APIRouter, HTTPException
from typing import List, Dict
from ..services.wifi_pentest import WiFiPentest

router = APIRouter()
wifi_pentest = WiFiPentest()

@router.post("/monitor/start")
async def start_monitor_mode() -> Dict:
    """Включение режима мониторинга"""
    return await wifi_pentest.start_monitor_mode()

@router.post("/monitor/stop")
async def stop_monitor_mode() -> Dict:
    """Выключение режима мониторинга"""
    return await wifi_pentest.stop_monitor_mode()

@router.get("/scan")
async def scan_networks() -> List[Dict]:
    """Сканирование WiFi сетей"""
    return await wifi_pentest.scan_networks()

@router.post("/attack/deauth")
async def start_deauth_attack(bssid: str, client_mac: str = "FF:FF:FF:FF:FF:FF") -> Dict:
    """Запуск деаутентификации"""
    return await wifi_pentest.start_deauth_attack(bssid, client_mac)

@router.post("/attack/stop/{attack_id}")
async def stop_attack(attack_id: str) -> Dict:
    """Остановка атаки"""
    return await wifi_pentest.stop_attack(attack_id)

@router.post("/attack/fake_ap")
async def create_fake_ap(ssid: str, channel: int = 1) -> Dict:
    """Создание фейковой точки доступа"""
    return await wifi_pentest.create_fake_ap(ssid, channel)

@router.post("/capture/start")
async def start_packet_capture(bssid: str = None) -> Dict:
    """Запуск захвата пакетов"""
    return await wifi_pentest.start_packet_capture(bssid)

@router.get("/attacks")
async def get_active_attacks() -> List[Dict]:
    """Получение списка активных атак"""
    return await wifi_pentest.get_active_attacks() 