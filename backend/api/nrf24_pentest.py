from fastapi import APIRouter, HTTPException
from typing import List, Dict
from ..services.nrf24_pentest import NRF24Pentest

router = APIRouter()
nrf24_pentest = NRF24Pentest()

@router.post("/scan/start")
async def start_scan(start_channel: int = 0, end_channel: int = 125) -> Dict:
    """Запуск сканирования частот"""
    return await nrf24_pentest.start_scan(start_channel, end_channel)

@router.get("/scan/{scan_id}")
async def get_scan_results(scan_id: str) -> List[Dict]:
    """Получение результатов сканирования"""
    return await nrf24_pentest.get_scan_results(scan_id)

@router.post("/capture/start")
async def start_packet_capture(channel: int) -> Dict:
    """Запуск захвата пакетов"""
    return await nrf24_pentest.start_packet_capture(channel)

@router.post("/capture/stop/{capture_id}")
async def stop_capture(capture_id: str) -> Dict:
    """Остановка захвата пакетов"""
    return await nrf24_pentest.stop_capture(capture_id)

@router.post("/replay")
async def replay_packet(packet_data: List[int], channel: int) -> Dict:
    """Воспроизведение захваченного пакета"""
    return await nrf24_pentest.replay_packet(packet_data, channel) 